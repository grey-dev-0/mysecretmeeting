(function(e,n,t){n(document).ready(function(){window.rtc=new e({el:"#app",data:{config:{iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"}]},connections:{qr_code:null,my_connection:{websocket_id:null,connection:null,stream:null,error:null}},channels:{},websocket:null},methods:{init:function(e){this.websocket=new WebSocket("wss://"+e+"/websocket");this.websocket.onopen=function(){rtc.websocket.send(JSON.stringify({action:"init"}))};this.websocket.onmessage=function(e){var n=JSON.parse(e.data);switch(n.action){case"init":rtc.connections.qr_code=n.qr_code;rtc.connections.my_connection.websocket_id=n.id;rtc.connect(n.id);new t("#copy-url");break}}},connect:function(e){var n;if(this.connections.my_connection.websocket_id==e){n=this.connections.my_connection.connection=new RTCPeerConnection(this.config);this.emitStream(n)}else{n=new RTCPeerConnection(this.config);this.connections[e]={connection:n}}},emitStream:function(n){var e=function(e){rtc.connections.my_connection.stream=e;setTimeout(function(){rtc.$refs.my_video[0].srcObject=e});n.addStream(e)};var t=function(e){rtc.connections.my_connection.error=e.message};var o={audio:true,video:true};switch(true){case navigator.getUserMedia!==undefined:navigator.getUserMedia(o,e,t);break;case navigator.webkitGetUserMedia!==undefined:navigator.webkitGetUserMedia(o,e,t);break;case navigator.mediaDevices!==undefined&&navigator.mediaDevices.getUserMedia!==undefined:navigator.mediaDevices.getUserMedia(o).then(e).catch(t);break;case navigator.mozGetUserMedia!==undefined:navigator.mozGetUserMedia(o,e,function(){});break;default:alert("Could NOT access Audio / Video Input!")}}}});n("body").on("click","#upload-qr, #capture-qr",function(){n(this).next("input").trigger("click")})})})(Vue,jQuery,ClipboardJS);